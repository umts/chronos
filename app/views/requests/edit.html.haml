%h1 Time Off Request

%h3
  - if @request.approved?
    Request approved by
    = @request.approved_by.full_name
  - elsif @request.pending?
    Request pending approval

- if can_approve_request
  - if @request.approved?
    = button_to 'Reject',
                update_status_request_path(@request, params: { request_status_id: RequestStatus.rejected }),
                class: 'btn btn-danger btn-lg'
  - else
    = button_to 'Approve',
                update_status_request_path(@request, params: { request_status_id: RequestStatus.approved }),
                class: 'btn btn-success btn-lg'

= form_for @request, html: { class: 'form-horizontal' } do |f|
  .form-group
    .control-label.col-xs-2
      = f.label :name, 'Name'
    .col-xs-5
      = text_field_tag :name, @request.user.first_name + ' ' + @request.user.last_name,
                              class: 'form-control',
                              disabled: true
  .form-group
    .control-label.col-xs-2
      = f.label :date, 'Date'
    .col-xs-5
      = f.date_field :date, class: 'datepicker form-control', required: true, disabled: !can_update_request
  .form-group
    .control-label.col-xs-2
      = f.label :start_time, 'Start Time'
    .col-xs-5
      = f.time_field :start_time, class: 'form-control', required: true, disabled: !can_update_request
  .form-group
    .control-label.col-xs-2
      = f.label :end_time, 'End Time'
    .col-xs-5
      = f.time_field :end_time, class: 'form-control', required: true, disabled: !can_update_request
  .form-group
    .control-label.col-xs-2
      = f.label :request_type_id, 'Type'
    .col-xs-5
      = f.select :request_type_id,
                 @request_types.collect { |rt| ["#{rt.description} (#{rt.code})", rt.id] },
                 { include_blank: 'None' },
                 class: 'selectpicker form-control',
                 required: true,
                 disabled: !can_update_request

  .form-group
    .col-xs-offset-2.col-xs-5
      = f.submit('Update', class: 'btn btn-primary') if can_update_request
      = link_to 'Cancel', requests_path, class: 'btn btn-default'
